---
interface Props {
	class?: string;
}

const { class: className = "" } = Astro.props;
---

<button
	id="back-to-top"
	class:list={[
		"fixed bottom-6 right-6 z-40 flex size-12 items-center justify-center rounded-full bg-gray-800 text-white shadow-lg transition-opacity duration-200 ease-out hover:bg-gray-700 motion-reduce:transition-none",
		"opacity-0 pointer-events-none",
		className,
	]}
	aria-label="ページトップへ戻る"
>
	<svg
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 20 20"
		fill="currentColor"
		class="size-5"
	>
		<path
			fill-rule="evenodd"
			d="M10 17a.75.75 0 0 1-.75-.75V5.612L5.29 9.77a.75.75 0 0 1-1.08-1.04l5.25-5.5a.75.75 0 0 1 1.08 0l5.25 5.5a.75.75 0 1 1-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0 1 10 17Z"
			clip-rule="evenodd"
		/>
	</svg>
</button>

<script>
	const backToTopBtn = document.getElementById("back-to-top");

	if (backToTopBtn) {
		const showThreshold = 300;

		const toggleVisibility = () => {
			if (window.scrollY > showThreshold) {
				backToTopBtn.classList.remove("opacity-0", "pointer-events-none");
				backToTopBtn.classList.add("opacity-100", "pointer-events-auto");
			} else {
				backToTopBtn.classList.add("opacity-0", "pointer-events-none");
				backToTopBtn.classList.remove("opacity-100", "pointer-events-auto");
			}
		};

		window.addEventListener("scroll", toggleVisibility, { passive: true });
		toggleVisibility();

		backToTopBtn.addEventListener("click", () => {
			window.scrollTo({ top: 0, behavior: "smooth" });
		});
	}
</script>
