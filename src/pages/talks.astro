---
import Layout from "../layouts/Layout.astro";
import { getCollection } from "astro:content";

const talksEntries = await getCollection("talks");
const talksData = talksEntries[0]?.data.items || [];
const sortedTalks = talksData.sort(
	(a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()
);

const formatDate = (date: Date | string) => {
	const dateObj = typeof date === "string" ? new Date(date) : date;
	return new Intl.DateTimeFormat("ja-JP", {
		year: "numeric",
		month: "long",
		day: "numeric",
	}).format(dateObj);
};
---

<Layout
	title="Talks | Portfolio"
	description="登壇情報。これまでの講演やプレゼンテーションの記録です。"
>
	<main class="mx-auto max-w-4xl px-6 py-12">
		<h1 class="mb-12 text-4xl font-bold">Talks</h1>

		<div class="space-y-6">
			{sortedTalks.map((talk) => (
				<article class="border-l-4 border-gray-300 pl-6">
					<time class="mb-2 block text-sm text-gray-600">
						{formatDate(talk.date)}
					</time>
					{talk.url ? (
						<a
							href={talk.url}
							target="_blank"
							rel="noopener noreferrer"
							class="text-xl font-bold hover:text-gray-600"
						>
							{talk.title} →
						</a>
					) : (
						<h2 class="text-xl font-bold">{talk.title}</h2>
					)}
				</article>
			))}
		</div>

		{sortedTalks.length === 0 && (
			<p class="text-gray-600">登壇情報はまだありません。</p>
		)}
	</main>
</Layout>
