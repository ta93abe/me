---
import { Image } from "astro:assets";
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import { formatDate } from "../../utils/date";
import Breadcrumb from "../../components/Breadcrumb.astro";

export async function getStaticPaths() {
	const works = await getCollection("works");
	return works.map((work) => ({
		params: { id: work.id },
		props: { work },
	}));
}

const { work } = Astro.props;
const { Content } = await render(work);
---

<Layout
	title={`${work.data.title} | Works | Portfolio`}
	description={work.data.excerpt}
>
	<main class="mx-auto max-w-4xl px-6 py-12">
		<Breadcrumb
			items={[
				{ label: "ホーム", href: "/" },
				{ label: "Works", href: "/works" },
				{ label: work.data.title },
			]}
		/>
		<div class="mb-8">
			<a
				href="/works"
				class="mb-4 inline-block text-sm text-gray-600 hover:text-gray-900"
			>
				← Works一覧へ戻る
			</a>
			<h1 class="mb-4 text-4xl font-bold">{work.data.title}</h1>
			<p class="mb-4 text-gray-600">
				{formatDate(work.data.startDate)}
				{work.data.endDate && ` - ${formatDate(work.data.endDate)}`}
			</p>
			<div class="mb-6 flex flex-wrap gap-2">
				{work.data.keywords.map((keyword) => (
					<span class="rounded-full bg-gray-100 px-4 py-2 text-sm">
						{keyword}
					</span>
				))}
			</div>
		</div>

		<div class="mb-8 aspect-video overflow-hidden rounded-lg">
			<Image
				src={work.data.coverImage}
				alt={work.data.title}
				class="h-full w-full object-cover"
			/>
		</div>

		<article class="prose prose-lg max-w-none">
			<Content />
		</article>
	</main>
</Layout>
