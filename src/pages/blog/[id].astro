---
import Layout from "../../layouts/Layout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
	const blogPosts = await getCollection("blog");
	return blogPosts.map((post) => ({
		params: { id: post.id },
		props: { post },
	}));
}

const { post } = Astro.props;
const { Content } = await render(post);

const formatDate = (date: Date) => {
	return new Intl.DateTimeFormat("ja-JP", {
		year: "numeric",
		month: "long",
		day: "numeric",
	}).format(date);
};
---

<Layout
	title={`${post.data.title} | Blog | Portfolio`}
	description={post.data.excerpt}
>
	<main class="mx-auto max-w-4xl px-6 py-12">
		<div class="mb-8">
			<a
				href="/blog"
				class="mb-4 inline-block text-sm text-gray-600 hover:text-gray-900"
			>
				← Blog一覧へ戻る
			</a>
			<h1 class="mb-4 text-4xl font-bold">{post.data.title}</h1>
			<time class="block text-gray-600">
				{formatDate(post.data.date)}
				{post.data.updatedDate && (
					<span class="ml-2 text-sm">
						(更新: {formatDate(post.data.updatedDate)})
					</span>
				)}
			</time>
		</div>

		<article class="prose prose-lg max-w-none">
			<Content />
		</article>
	</main>
</Layout>
